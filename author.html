<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <title>Admin Control</title>
    <script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.12.0/dist/av-min.js"></script>
    <style>
        body {
            font-family: sans-serif;
            background: #121212;
            color: #fff;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .post-card {
            background: #1e1e1e;
            border: 1px solid #333;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
        }

        .btn-del {
            background: #ff4757;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
        }
    </style>
</head>

<body>
    <h2>ğŸ‘‘ å…¨ç«™åå°ç®¡ç†</h2>
    <div id="admin-list">åŠ è½½ä¸­...</div>
    <br><a href="index.html" style="color:#888;">è¿”å›é¦–é¡µ</a>

    <script>
        // ç»Ÿä¸€ä½¿ç”¨è¿™ä¸ªæ­£ç¡®çš„ç”µæºå—
        AV.init({
            appId: "M7KeNAw2myFEaXvSEJPbtPpA-MdYXbMMI",
            appKey: "O9DYEDbkHLvecHlEact4ANKO",
            serverURL: "https://m7kenaw2.api.lncldglobal.com"
        });

        async function draw() {
            const query = new AV.Query('Post');
            query.descending('createdAt');
            const posts = await query.find();
            document.getElementById('admin-list').innerHTML = posts.map(p => `
                <div class="post-card">
                    <div>
                        <b>${p.get('title')}</b> (ID: ${p.id})<br>
                        <small>ä½œè€…: ${p.get('nickname')} | èµ: ${p.get('likes')}</small>
                    </div>
                    <button class="btn-del" onclick="realDelete('${p.id}')">æ°¸ä¹…åˆ é™¤</button>
                </div>
            `).join('');
        }

        async function realDelete(id) {
            if (confirm('ä½œä¸ºç«™é•¿ï¼Œä½ ç¡®å®šè¦æ°¸ä¹…åˆ é™¤è¿™æ¡å…¨ç½‘å¯è§çš„å¸–å­å—ï¼Ÿ')) {
                const post = AV.Object.createWithoutData('Post', id);
                await post.destroy();
                draw();
            }
        }
        draw();
    </script>
</body>

</html>
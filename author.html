<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ç®¡ç†åå° Admin Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/leancloud-storage@4.12.0/dist/av-min.js"></script>
    <style>
        body { background: #121212; color: #fff; font-family: sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .post-card { background: #1e1e1e; padding: 15px; margin-bottom: 10px; border-radius: 10px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #333; }
        button:active { transform: scale(1.1); }
        .btn-del { background: #ff4757; color: white; border: none; padding: 8px 15px; border-radius: 6px; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>
    <script>
        // ğŸ”¥ æƒé™åŒé‡æ ¡éªŒï¼šlocalStorage + window.name
        if (localStorage.getItem('isAdmin') !== 'true' && window.name !== 'isAdmin_true') {
            window.location.href = 'index.html';
        }
    </script>
    <h2>ğŸ‘‘ Admin Dashboard</h2>
    <div id="admin-list">Loading...</div>
    <br><a href="index.html" style="color:#888; text-decoration: none;">ğŸ  Home</a>

    <script>
        AV.init({ appId: "M7KeNAw2myFEaXvSEJPbtPpA-MdYXbMMI", appKey: "O9DYEDbkHLvecHlEact4ANKO", serverURL: "https://m7kenaw2.api.lncldglobal.com" });
        async function draw() {
            try {
                const query = new AV.Query('Post').descending('createdAt');
                const posts = await query.find();
                document.getElementById('admin-list').innerHTML = posts.map(p => `
                    <div class="post-card">
                        <div><b>${p.get('title')}</b><br><small>By: ${p.get('nickname')} | ğŸ‘ ${p.get('likes') || 0}</small></div>
                        <button class="btn-del" onclick="del('${p.id}')">Delete</button>
                    </div>`).join('');
            } catch (err) { console.error(err); }
        }
        async function del(id) { if(confirm('ç¡®å®šåˆ é™¤æ­¤è´´ï¼Ÿ')) { await AV.Object.createWithoutData('Post', id).destroy(); draw(); } }
        draw();
    </script>
</body>
</html>